{"ast":null,"code":"import _slicedToArray from\"/home/aarthi/fitgit/react/einstop-sales-management-system/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _readOnlyError from\"/home/aarthi/fitgit/react/einstop-sales-management-system/frontend/node_modules/@babel/runtime/helpers/esm/readOnlyError.js\";import React,{useState}from'react';import SalesDataService from'../services/sales.js';import{useEffect}from'react';import'../App.css';import DatePicker from\"react-datepicker\";import\"react-datepicker/dist/react-datepicker.css\";import{Chart}from\"react-google-charts\";import dayjs from'dayjs';import priceFormatter from'../services/priceFormatter.js';import{Link,Route,Routes}from'react-router-dom';import Login from'./login.js';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var SalesList=function SalesList(props){var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),sales=_React$useState2[0],setSales=_React$useState2[1];var _React$useState3=React.useState(\"\"),_React$useState4=_slicedToArray(_React$useState3,2),queryLocation=_React$useState4[0],setQueryLocation=_React$useState4[1];var _React$useState5=React.useState(),_React$useState6=_slicedToArray(_React$useState5,2),queryCoupons=_React$useState6[0],setQueryCoupons=_React$useState6[1];var _React$useState7=React.useState(\"\"),_React$useState8=_slicedToArray(_React$useState7,2),queryPurchaseMethod=_React$useState8[0],setQueryPurchaseMethod=_React$useState8[1];var _React$useState9=React.useState([\"Any\"]),_React$useState10=_slicedToArray(_React$useState9,2),purchaseMethods=_React$useState10[0],setPurchaseMethods=_React$useState10[1];var _React$useState11=React.useState(0),_React$useState12=_slicedToArray(_React$useState11,2),pages=_React$useState12[0],setQueryPage=_React$useState12[1];var _React$useState13=React.useState([\"All\"]),_React$useState14=_slicedToArray(_React$useState13,2),locations=_React$useState14[0],setLocations=_React$useState14[1];var _React$useState15=React.useState(new Date('1/2/2013')),_React$useState16=_slicedToArray(_React$useState15,2),startDate=_React$useState16[0],setstartDate=_React$useState16[1];var _React$useState17=React.useState(new Date('12/30/2017')),_React$useState18=_slicedToArray(_React$useState17,2),endDate=_React$useState18[0],setendDate=_React$useState18[1];var _React$useState19=React.useState(false),_React$useState20=_slicedToArray(_React$useState19,2),NoSalesFlag=_React$useState20[0],setNoSalesFlag=_React$useState20[1];var _React$useState21=React.useState(null),_React$useState22=_slicedToArray(_React$useState21,2),modifiedSales=_React$useState22[0],setModifiedSales=_React$useState22[1];var _useState=useState(0),_useState2=_slicedToArray(_useState,2),totalSales=_useState2[0],settotalSales=_useState2[1];var _useState3=useState(0.0),_useState4=_slicedToArray(_useState3,2),revenue=_useState4[0],setRevenue=_useState4[1];var _useState5=useState(new Date('1/2/2013')),_useState6=_slicedToArray(_useState5,2),minDate=_useState6[0],setMinDate=_useState6[1];var _useState7=useState(new Date('12/30/2017')),_useState8=_slicedToArray(_useState7,2),maxDate=_useState8[0],setMaxDate=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),trigger=_useState10[0],setTrigger=_useState10[1];useEffect(function(){retrieveSales();retrievePurchaseMethod();retrieveLocations();},[]);var onChangeQueryLocation=function onChangeQueryLocation(e){var searchLocation=e.target.value;setQueryLocation(searchLocation);};var onChangeQueryCoupons=function onChangeQueryCoupons(e){var searchCoupons=e.target.checked?true:false;setQueryCoupons(searchCoupons);};var onChangeQueryPurchaseMethod=function onChangeQueryPurchaseMethod(e){var searchPurchaseMethod=e.target.value;setQueryPurchaseMethod(searchPurchaseMethod);};var onChangeSetstartDate=function onChangeSetstartDate(e){setstartDate(e);};var onChangeSetendDate=function onChangeSetendDate(e){setendDate(e);};var retrieveSales=function retrieveSales(){SalesDataService.getAll().then(function(response){setSales(response.data.Sales);}).catch(function(e){console.log(e);});setNoSalesFlag(true);};var retrievePurchaseMethod=function retrievePurchaseMethod(){SalesDataService.getPurchaseMethod().then(function(response){setPurchaseMethods([\"Any\"].concat(response.data));setNoSalesFlag(true);}).catch(function(e){console.log(e);});};var retrieveLocations=function retrieveLocations(){SalesDataService.getStoreLocations().then(function(response){setLocations([\"All\"].concat(response.data));setNoSalesFlag(true);}).catch(function(e){console.log(e);});};var refreshList=function refreshList(){retrieveSales();setNoSalesFlag(true);};var find=function find(query,by){SalesDataService.find(query,by).then(function(response){setSales(response.data.Sales);modifySalesFormat();setNoSalesFlag(true);}).catch(function(e){console.log(e);});};var modifySalesFormat=function modifySalesFormat(){var modified=[['Location','Date (MM-DD-YYYY)','Customer','Rating','Purchase Method','Coupon used']];var total=0;var revenue=0;sales.map(function(sale){if(dayjs(sale.saleDate)>dayjs(startDate)&&dayjs(sale.saleDate)<dayjs(endDate)){var m=[];m.push(sale.storeLocation);m.push(dayjs(sale.saleDate).format('MM-DD-YYYY'));m.push(sale.customer.email);m.push(sale.customer.satisfaction);m.push(sale.purchaseMethod);m.push(sale.couponUsed);modified.push(m);sale.items.map(function(item){total+=parseInt(item.quantity);revenue+=parseInt(item.quantity)*item.price['$numberDecimal'];});}});modified.sort(function(a,b){return dayjs(b[1]).toDate()-dayjs(a[1]).toDate();});if(modified.length>1){setModifiedSales(modified);settotalSales(total);setRevenue(revenue);}};var findAllFilters=function findAllFilters(){if(queryLocation===\"Any\")null,_readOnlyError(\"queryLocation\");if(queryPurchaseMethod===\"All\")null,_readOnlyError(\"queryPurchaseMethod\");SalesDataService.findAll(queryLocation,queryPurchaseMethod,queryCoupons).then(function(response){setSales(response.data.Sales);modifySalesFormat(sales);}).catch(function(e){console.log(e);});};return props.loggedIn?/*#__PURE__*/_jsx(\"div\",{className:\"container wrapper App\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row py-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-2\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"sticky-top\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"nav flex-column\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-outline form-white\",children:[/*#__PURE__*/_jsx(\"select\",{class:\"form-control selectinput\",type:\"select\",onChange:onChangeQueryPurchaseMethod,children:purchaseMethods.map(function(method){return/*#__PURE__*/_jsxs(\"option\",{value:method,children:[\" \",method,\" \"]});})}),/*#__PURE__*/_jsx(\"label\",{class:\"form-label\",for:\"formWhite1\",children:\"Purchase Method\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-outline form-white\",children:[/*#__PURE__*/_jsx(\"select\",{class:\"form-control selectinput\",type:\"select\",onChange:onChangeQueryLocation,children:locations.map(function(method){return/*#__PURE__*/_jsxs(\"option\",{value:method,children:[\" \",method,\" \"]});})}),/*#__PURE__*/_jsx(\"label\",{class:\"form-label\",for:\"formWhite2\",children:\"Location\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-outline form-white\",children:[/*#__PURE__*/_jsx(DatePicker,{className:\"form-control input\",id:\"startDate\",onChange:onChangeSetstartDate,selected:minDate,startDate:minDate,endDate:maxDate}),/*#__PURE__*/_jsx(\"label\",{class:\"form-label\",for:\"formWhite3\",children:\"From\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-outline form-white\",children:[/*#__PURE__*/_jsx(DatePicker,{className:\"form-control input\",id:\"endDate\",onChange:onChangeSetendDate,selected:maxDate,startDate:minDate,endDate:maxDate}),/*#__PURE__*/_jsx(\"label\",{class:\"form-label\",for:\"formWhite4\",children:\"To\"})]}),/*#__PURE__*/_jsx(\"div\",{class:\"custom-control custom-switch\",children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",class:\"regular-checkbox big-checkbox\",onChange:onChangeQueryCoupons,id:\"customSwitch2\"})}),/*#__PURE__*/_jsx(\"label\",{class:\"form-label\",for:\"formWhite6\",children:\"Coupons\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"input-group-append mb-3\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-dark\",type:\"button\",onClick:findAllFilters,children:\"Apply All Filters\"})})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"row py-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-12\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body card-bg-dark \",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"card-title card-bg-dark\",children:\"STATS\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"card-text card-bg-dark\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Total Sales : \"}),priceFormatter(totalSales),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"Revenue: \"}),priceFormatter(Math.trunc(revenue)),/*#__PURE__*/_jsx(\"br\",{})]})]})})})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-1\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col\",children:NoSalesFlag&&modifiedSales?/*#__PURE__*/_jsx(Chart,{chartType:\"Table\",width:\"100%\",height:\"100%\",data:modifiedSales,options:{allowHtml:true,title:\"Sales\",legend:{position:\"top\"},pageSize:25,width:\"100%\",height:\"100%\",cssClassNames:{'headerRow':'font-color-white large-font bold-font black-background gold-border','tableRow':'light-coral-background font-color-black bold-font','oddTableRow':'orange-background font-color-black bold-font','selectedTableRow':'light-orange-background large-font','hoverTableRow':'light-orange-background large-font','headerCell':'gold-border','tableCell':'text-font right-text deeppink-border','rowNumberCell':'underline-blue-font','footer':'black-background'}}}):/*#__PURE__*/_jsx(\"div\",{class:\"jumbotron jumbotron-fluid\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{class:\"display-4\",children:\"No Such Sales Exist :(\"}),/*#__PURE__*/_jsxs(\"p\",{class:\"lead\",children:[\"Try the following\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"li\",{children:\"Change the filters\"}),/*#__PURE__*/_jsxs(\"li\",{children:[\"Click on \",/*#__PURE__*/_jsx(\"div\",{className:\"text-italics\",children:\"Apply All Filters\"}),\" two times if \",/*#__PURE__*/_jsx(\"div\",{className:\"text-italics\",children:\"desired\"}),\" results are not obtained\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"Currently only sales dated between \",/*#__PURE__*/_jsx(\"div\",{className:\"text-italics\",children:\"2013\"}),\" and \",/*#__PURE__*/_jsx(\"div\",{className:\"text-italics\",children:\"2017\"}),\" exist\"]})]})]})})})]})}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{class:\"jumbotron jumbotron-fluid\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{class:\"display-4\",children:\"Log In to continue\"}),/*#__PURE__*/_jsxs(\"p\",{class:\"lead\",children:[\"Head on to \",/*#__PURE__*/_jsx(Link,{to:\"/supply\",children:\"Login Page\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"container mt-3\",children:/*#__PURE__*/_jsx(Routes,{children:/*#__PURE__*/_jsx(Route,{path:\"/supply\",element:/*#__PURE__*/_jsx(Login,{login:props.login})})})})]});};export default SalesList;","map":{"version":3,"sources":["/home/aarthi/fitgit/react/einstop-sales-management-system/frontend/src/components/sales-list.js"],"names":["React","useState","SalesDataService","useEffect","DatePicker","Chart","dayjs","priceFormatter","Link","Route","Routes","Login","SalesList","props","sales","setSales","queryLocation","setQueryLocation","queryCoupons","setQueryCoupons","queryPurchaseMethod","setQueryPurchaseMethod","purchaseMethods","setPurchaseMethods","pages","setQueryPage","locations","setLocations","Date","startDate","setstartDate","endDate","setendDate","NoSalesFlag","setNoSalesFlag","modifiedSales","setModifiedSales","totalSales","settotalSales","revenue","setRevenue","minDate","setMinDate","maxDate","setMaxDate","trigger","setTrigger","retrieveSales","retrievePurchaseMethod","retrieveLocations","onChangeQueryLocation","e","searchLocation","target","value","onChangeQueryCoupons","searchCoupons","checked","onChangeQueryPurchaseMethod","searchPurchaseMethod","onChangeSetstartDate","onChangeSetendDate","getAll","then","response","data","Sales","catch","console","log","getPurchaseMethod","concat","getStoreLocations","refreshList","find","query","by","modifySalesFormat","modified","total","map","sale","saleDate","m","push","storeLocation","format","customer","email","satisfaction","purchaseMethod","couponUsed","items","item","parseInt","quantity","price","sort","a","b","toDate","length","findAllFilters","findAll","loggedIn","method","Math","trunc","allowHtml","title","legend","position","pageSize","width","height","cssClassNames","login"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport SalesDataService from '../services/sales.js'\nimport { useEffect } from 'react';\nimport '../App.css'\nimport DatePicker from \"react-datepicker\";\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport { Chart } from \"react-google-charts\";\nimport dayjs from 'dayjs' ;\nimport priceFormatter from '../services/priceFormatter.js'\nimport {Link, Route, Routes} from 'react-router-dom' ;\nimport Login from './login.js'\n\n\nconst SalesList = props => {\n  const [sales, setSales] = React.useState([])\n  const [queryLocation, setQueryLocation] = React.useState(\"\")\n  const [queryCoupons, setQueryCoupons] = React.useState()\n  const [queryPurchaseMethod, setQueryPurchaseMethod] = React.useState(\"\")\n  const [purchaseMethods, setPurchaseMethods] = React.useState([\"Any\"]);\n  const [pages, setQueryPage] = React.useState(0) \n  const [locations,  setLocations] = React.useState([\"All\"])\n  const [startDate, setstartDate] = React.useState(new Date('1/2/2013'))\n  const [endDate, setendDate] = React.useState(new Date('12/30/2017'))\n  const [NoSalesFlag, setNoSalesFlag] = React.useState(false)\n  const [modifiedSales, setModifiedSales] = React.useState(null)\n  const [totalSales, settotalSales] = useState(0)\n  const [revenue, setRevenue]=useState(0.0)\n  const [minDate, setMinDate] = useState(new Date('1/2/2013'))\n  const [maxDate, setMaxDate] = useState(new Date('12/30/2017'))\n  const [trigger, setTrigger] = useState(false)\n  \n  useEffect(() => {\n    retrieveSales();\n    retrievePurchaseMethod();\n    retrieveLocations();\n  }, []);\n\n\n  const onChangeQueryLocation = e => {\n    const searchLocation = e.target.value;\n    setQueryLocation(searchLocation);\n  };\n\n  const onChangeQueryCoupons = e => {\n    const searchCoupons = (e.target.checked?true:false)\n    setQueryCoupons(searchCoupons);\n  };\n\n  const onChangeQueryPurchaseMethod = e => {\n    const searchPurchaseMethod = e.target.value;\n    setQueryPurchaseMethod(searchPurchaseMethod);\n  };\n\n  const onChangeSetstartDate = e => {\n    setstartDate(e)\n  }\n\n  const onChangeSetendDate = e => {\n    setendDate(e)\n  }\n\n  const retrieveSales = () => {\n    SalesDataService.getAll()\n      .then(response => {\n        setSales(response.data.Sales);\n      })\n      .catch(e => {\n        console.log(e);\n      });\n      setNoSalesFlag(true)\n  };\n\n  const retrievePurchaseMethod = () => {\n    SalesDataService.getPurchaseMethod()\n      .then(response => {\n        setPurchaseMethods([\"Any\"].concat(response.data));\n        setNoSalesFlag(true)\n      })\n      .catch(e => {\n        console.log(e);\n      });\n      \n  };\n\n  const retrieveLocations = () => {\n    SalesDataService.getStoreLocations()\n    .then(response => {\n      setLocations([\"All\"].concat(response.data));\n      setNoSalesFlag(true)\n    })\n    .catch(e => {\n      console.log(e);\n    });\n  }\n\n  const refreshList = () => {\n    retrieveSales();\n    setNoSalesFlag(true)\n  };\n\n  const find = (query, by) => {\n    SalesDataService.find(query, by)\n      .then(response => {\n        \n        setSales(response.data.Sales);\n\n        modifySalesFormat() \n        setNoSalesFlag(true)\n      })\n      .catch(e => {\n        console.log(e);\n      });\n  };\n\n  const modifySalesFormat = () => {\n    \n    var modified = [['Location','Date (MM-DD-YYYY)','Customer','Rating','Purchase Method','Coupon used']]\n    var total=0;\n    var revenue=0\n    sales.map(sale => {\n      if(dayjs(sale.saleDate) > dayjs(startDate) && dayjs(sale.saleDate) < dayjs(endDate)) {\n        var m = []\n        m.push(sale.storeLocation)\n        m.push(dayjs(sale.saleDate).format('MM-DD-YYYY'))\n        m.push(sale.customer.email)\n        m.push(sale.customer.satisfaction)\n        m.push(sale.purchaseMethod)\n        m.push(sale.couponUsed)\n        modified.push(m) \n        sale.items.map(item=>{\n          total+=(parseInt(item.quantity))\n          revenue+=(parseInt(item.quantity)*item.price['$numberDecimal'])\n        })\n      }\n    })\n\n    modified.sort((a,b) => (dayjs(b[1]).toDate())-(dayjs(a[1]).toDate()))\n\n    if(modified.length>1) {\n      setModifiedSales(modified)\n      settotalSales(total)\n      setRevenue(revenue)\n    }\n\n  }\n\n  const findAllFilters = () => {\n    if(queryLocation === \"Any\") queryLocation = null\n    if(queryPurchaseMethod === \"All\") queryPurchaseMethod = null\n    SalesDataService.findAll(queryLocation, queryPurchaseMethod, queryCoupons)\n    .then(response => {\n      setSales(response.data.Sales)\n      modifySalesFormat(sales)\n    })\n    .catch(e => {\n        console.log(e)\n    })\n  }\n\n  return (\n      props.loggedIn ? ( \n      <div className='container wrapper App'>\n      <div className='row py-3'>\n        <div className=\"col-2\">\n        <div class=\"sticky-top\">\n        <div class=\"nav flex-column\">     \n          <div className=\"form-outline form-white\">\n              <select class=\"form-control selectinput\" type=\"select\" onChange={onChangeQueryPurchaseMethod}>\n                {\n                  purchaseMethods.map(method => {\n                    return (\n                      <option value={method}> {method} </option>\n                    )\n                  })\n                }\n              </select>\n              <label class=\"form-label\" for=\"formWhite1\">Purchase Method</label>\n          </div>\n        <div className=\"form-outline form-white\">\n          <select class=\"form-control selectinput\" type='select'  onChange={onChangeQueryLocation}>\n              {\n                locations.map(method => {\n                  return (\n                    <option value={method}> {method} </option>\n                  )\n                })\n              }\n            </select>\n            <label class=\"form-label\" for=\"formWhite2\">Location</label>\n            {/* <div className=\"input-group-append\">\n                <button className=\"btn btn-outline-dark\" onClick={findByLocation}>Apply</button>\n            </div> */}\n        </div>\n        <div className=\"form-outline form-white\">\n            <DatePicker\n                className='form-control input'\n\t\t\t\t\t\t\t\tid=\"startDate\"\n\t\t\t\t\t\t\t\tonChange={onChangeSetstartDate}\n\t\t\t\t\t\t\t\tselected={minDate}\n                startDate={minDate}\n                endDate={maxDate}\n\t\t\t\t\t\t\t/>\n            <label class=\"form-label\" for=\"formWhite3\">From</label>\n        </div>\n        <div className=\"form-outline form-white\">\n            <DatePicker\n                className='form-control input' \n\t\t\t\t\t\t\t\tid=\"endDate\"\n\t\t\t\t\t\t\t\tonChange={onChangeSetendDate}\n\t\t\t\t\t\t\t\tselected={maxDate}\n                startDate={minDate}\n                endDate={maxDate}\n\t\t\t\t\t\t\t/>\n              <label class=\"form-label\" for=\"formWhite4\">To</label>\n        </div>   \n        <div class=\"custom-control custom-switch\">\n          <input type=\"checkbox\"  class=\"regular-checkbox big-checkbox\" onChange={onChangeQueryCoupons} id=\"customSwitch2\" />\n        </div>\n        <label class=\"form-label\" for=\"formWhite6\">Coupons</label>\n        <br/>\n        <br/>\n        <div className=\"input-group-append mb-3\">\n          <button\n            className=\"btn btn-outline-dark\"\n            type=\"button\"\n            onClick={findAllFilters}\n          >\n            Apply All Filters\n          </button>\n        </div>\n      </div>  \n        <br/>\n        <br/>\n        <div className='row py-3'>\n        <div className=\"col-12\">\n              <div className=\"card\">\n                <div className=\"card-body card-bg-dark \">\n                  <h5 className=\"card-title card-bg-dark\">STATS</h5>\n                  <p className=\"card-text card-bg-dark\">\n                    <strong>Total Sales : </strong>{priceFormatter(totalSales)}<br/>\n                    <strong>Revenue: </strong>{priceFormatter(Math.trunc(revenue))}<br/>\n                  </p>\n                </div>\n              </div>\n            </div>\n      </div>\n      </div> \n      </div>\n      <div className='col-1'></div>\n      <div className=\"col\">\n      { \n        NoSalesFlag && modifiedSales ?\n        <Chart\n            chartType=\"Table\"\n            width=\"100%\"\n            height=\"100%\"\n            data={modifiedSales}\n            options={{     \n              allowHtml: true,\n              title: \"Sales\",\n              legend: { position: \"top\" },\n              pageSize: 25,\n              width:\"100%\",\n              height:\"100%\",\n              cssClassNames: {\n                'headerRow': 'font-color-white large-font bold-font black-background gold-border',\n                'tableRow': 'light-coral-background font-color-black bold-font',\n                'oddTableRow': 'orange-background font-color-black bold-font',\n                'selectedTableRow': 'light-orange-background large-font',\n                'hoverTableRow': 'light-orange-background large-font',\n                'headerCell': 'gold-border',\n                'tableCell': 'text-font right-text deeppink-border',\n                'rowNumberCell': 'underline-blue-font',\n                'footer':'black-background'\n              }            \n            }}\n          /> :\n          <div class=\"jumbotron jumbotron-fluid\">\n          <div class=\"container\">\n            <h1 class=\"display-4\">No Such Sales Exist :(</h1>\n            <p class=\"lead\">Try the following<br/>\n              <li>Change the filters</li>\n              <li>Click on <div className='text-italics'>Apply All Filters</div> two times if <div className='text-italics'>desired</div> results are not obtained</li>\n              <li>Currently only sales dated between <div className='text-italics'>2013</div> and <div className=\"text-italics\">2017</div> exist</li>\n            </p>\n          </div>\n        </div>\n      } \n      </div>\n      </div>\n    </div>\n    ) :\n    (<div>\n    <div class=\"jumbotron jumbotron-fluid\">\n      <div class=\"container\">\n        <h1 class=\"display-4\">Log In to continue</h1>\n        <p class=\"lead\">Head on to <Link to='/supply'>Login Page</Link></p>\n      </div>\n    </div>\n     <div className=\"container mt-3\">\n     <Routes>\n       <Route path=\"/supply\" element={<Login login={props.login}/>}\n       />\n     </Routes>\n     </div>\n     </div>\n    )\n   \n  );\n}\n\nexport default SalesList;"]},"metadata":{},"sourceType":"module"}